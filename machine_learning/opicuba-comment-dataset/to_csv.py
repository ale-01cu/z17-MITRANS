comentarios_sugerencia = [
    {"comment": "Sería bueno que pusieran más puntos de recarga de ETECSA en los barrios alejados.", "label": "sugerencia"},
    {"comment": "¿Por qué no ponen una guagua extra en los horarios pico?", "label": "sugerencia"},
    {"comment": "Podrían implementar una app para ver el horario de los trenes en tiempo real.", "label": "sugerencia"},
    {"comment": "Sería útil que los turnos médicos se pudieran pedir por internet.", "label": "sugerencia"},
    {"comment": "En la bodega podrían organizar mejor la distribución para evitar aglomeraciones.", "label": "sugerencia"},
    {"comment": "Si arreglan el alumbrado público del reparto, se evitarían muchos problemas de seguridad.", "label": "sugerencia"},
    {"comment": "Los bancos deberían habilitar más cajeros automáticos, sobre todo en zonas rurales.", "label": "sugerencia"},
    {"comment": "La empresa eléctrica debería avisar con más tiempo los cortes programados.", "label": "sugerencia"},
    {"comment": "¿Y si colocan toldos en las paradas para protegernos del sol y la lluvia?", "label": "sugerencia"},
    {"comment": "Estaría bien que los paquetes enviados desde el exterior se pudieran rastrear mejor.", "label": "sugerencia"},
    {"comment": "Los precios de la cafetería escolar deberían revisarse, son muy altos para algunos estudiantes.", "label": "sugerencia"},
    {"comment": "Podrían mejorar el servicio de limpieza en los hospitales.", "label": "sugerencia"},
    {"comment": "Estaría bueno que la televisión nacional pasara más películas cubanas actuales.", "label": "sugerencia"},
    {"comment": "Deberían vender productos de aseo en las bodegas al menos una vez al mes.", "label": "sugerencia"},
    {"comment": "¿Podrían considerar dar recargas con promociones también desde Cuba?", "label": "sugerencia"},
    {"comment": "Sería ideal que los ómnibus tuvieran un letrero digital con las paradas.", "label": "sugerencia"},
    {"comment": "¿Por qué no ponen wifi gratis en centros culturales y museos?", "label": "sugerencia"},
    {"comment": "Sería bueno que vendieran más productos nacionales en las tiendas en MLC.", "label": "sugerencia"},
    {"comment": "Los círculos infantiles podrían tener más actividades educativas fuera del aula.", "label": "sugerencia"},
    {"comment": "¿Podrían incluir opciones vegetarianas en los comedores escolares?", "label": "sugerencia"},
    {"comment": "Estaría bien que existiera una línea directa para reportar precios abusivos.", "label": "sugerencia"},
    {"comment": "Deberían arreglar los caminos secundarios, que están en muy mal estado.", "label": "sugerencia"},
    {"comment": "Podrían hacer campañas educativas sobre el ahorro de electricidad en los barrios.", "label": "sugerencia"},
    {"comment": "Sería útil un sistema de mensajes para informar cuándo hay medicamentos en farmacia.", "label": "sugerencia"},
    {"comment": "¿Han pensado en habilitar el pago de servicios por código QR en los mercados?", "label": "sugerencia"},
    {"comment": "Estaría bien que los envíos de combos online se organizaran por municipio.", "label": "sugerencia"},
    {"comment": "Podrían capacitar mejor al personal de atención al cliente.", "label": "sugerencia"},
    {"comment": "Sería ideal tener más espacios recreativos para jóvenes en los barrios.", "label": "sugerencia"},
    {"comment": "¿Y si implementan un sistema de citas online en las oficinas de trámites?", "label": "sugerencia"},
    {"comment": "Estaría bueno que los jóvenes pudieran tener bonos de navegación más económicos.", "label": "sugerencia"},
    {"comment": "Podrían instalar bebederos públicos en los parques y avenidas.", "label": "sugerencia"},
    {"comment": "Si los turnos del policlínico se dieran con un número digital, habría menos desorden.", "label": "sugerencia"},
    {"comment": "Sería bueno que los trabajadores sociales visitaran más a los ancianos solos.", "label": "sugerencia"},
    {"comment": "Estaría bien que los inspectores fueran más frecuentes en los mercados.", "label": "sugerencia"},
    {"comment": "Podrían crear una app para monitorear el consumo eléctrico de cada hogar.", "label": "sugerencia"},
    {"comment": "¿Por qué no hacen un noticiero más juvenil, con lenguaje más cercano?", "label": "sugerencia"},
    {"comment": "Sería muy útil un mapa interactivo de los cortes eléctricos.", "label": "sugerencia"},
    {"comment": "Los colectivos laborales podrían tener mejor ventilación en sus espacios.", "label": "sugerencia"},
    {"comment": "Podrían ampliar los horarios de los trenes locales.", "label": "sugerencia"},
    {"comment": "En los CDR podrían organizar talleres de cocina económica para las familias.", "label": "sugerencia"},
    {"comment": "Sería bueno crear huertos comunitarios en solares vacíos.", "label": "sugerencia"},
    {"comment": "¿Podrían mejorar la señal de radio en zonas montañosas?", "label": "sugerencia"},
    {"comment": "Estaría bien que los estudiantes universitarios tuvieran más apoyo con materiales didácticos.", "label": "sugerencia"},
    {"comment": "Los parques infantiles necesitan mantenimiento y pintura.", "label": "sugerencia"},
    {"comment": "¿Por qué no colocan dispensadores de gel en las entradas de los centros estatales?", "label": "sugerencia"},
    {"comment": "Los centros recreativos deberían tener horarios extendidos los fines de semana.", "label": "sugerencia"},
    {"comment": "Sería ideal incluir productos para diabéticos en la canasta básica.", "label": "sugerencia"},
    {"comment": "Podrían instalar baños públicos más limpios y accesibles.", "label": "sugerencia"},
    {"comment": "Estaría bueno que pusieran sombra en las áreas de espera del hospital.", "label": "sugerencia"},
    {"comment": "¿Han pensado en abrir bibliotecas móviles en zonas rurales?", "label": "sugerencia"},
    {"comment": "Sería útil que los resultados de laboratorio se pudieran consultar en línea.", "label": "sugerencia"},
    {"comment": "Los museos podrían tener entrada gratis los fines de semana para estudiantes.", "label": "sugerencia"},
    {"comment": "Podrían mejorar la señalización vial en las avenidas más transitadas.", "label": "sugerencia"},
    {"comment": "Sería genial que hicieran ferias de trueque comunitario más a menudo.", "label": "sugerencia"},
    {"comment": "Los medios podrían dedicar más tiempo a las iniciativas juveniles del país.", "label": "sugerencia"},
    {"comment": "¿Y si hacen una guía para padres sobre cómo usar mejor las plataformas educativas digitales?", "label": "sugerencia"},
    {"comment": "Podrían poner paneles solares en escuelas y hospitales para ahorrar energía.", "label": "sugerencia"},
    {"comment": "Sería bueno que las escuelas enseñaran más sobre economía doméstica.", "label": "sugerencia"},
    {"comment": "Estaría bien que hubiera más accesibilidad para personas con discapacidad en los buses.", "label": "sugerencia"},
    {"comment": "¿Podrían evaluar si es posible vender productos agrícolas directo del productor al cliente?", "label": "sugerencia"},
    {"comment": "Sería ideal que los eventos culturales se anunciaran por Telegram también.", "label": "sugerencia"},
    {"comment": "Podrían hacer festivales municipales para promover artistas jóvenes.", "label": "sugerencia"},
    {"comment": "Estaría bueno que los barrios tuvieran un día mensual para limpieza colectiva.", "label": "sugerencia"},
    {"comment": "¿Por qué no se abren más espacios de coworking con wifi en la ciudad?", "label": "sugerencia"},
    {"comment": "Sería útil que la prensa local tuviera una sección fija para propuestas vecinales.", "label": "sugerencia"},
    {"comment": "Podrían fomentar más el reciclaje de botellas y envases en los barrios.", "label": "sugerencia"},
    {"comment": "Estaría bien que los consultorios médicos tuvieran carteles informativos visibles.", "label": "sugerencia"},
    {"comment": "¿Y si habilitan líneas directas para denunciar maltrato en servicios públicos?", "label": "sugerencia"},
    {"comment": "Sería bueno que las escuelas hicieran más excursiones educativas.", "label": "sugerencia"},
    {"comment": "Podrían poner bancos para sentarse en las colas largas.", "label": "sugerencia"},
    {"comment": "Estaría bien crear un boletín digital municipal con informaciones útiles.", "label": "sugerencia"},
    {"comment": "¿Por qué no habilitan puntos de carga solar para celulares en lugares públicos?", "label": "sugerencia"},
    {"comment": "Sería ideal que las guaguas tuvieran ventiladores o ventanas que abran mejor.", "label": "sugerencia"},
    {"comment": "Podrían dar prioridad a los jubilados en ciertos servicios en línea.", "label": "sugerencia"},
    {"comment": "Los CADECA deberían tener carteles visibles con las tasas actualizadas.", "label": "sugerencia"},
    {"comment": "Estaría bueno que el sistema de colas se informatizara con números digitales.", "label": "sugerencia"},
    {"comment": "¿Podrían incluir talleres de formación digital en los Joven Club?", "label": "sugerencia"},
    {"comment": "Podrían organizar intercambios culturales entre provincias más seguido.", "label": "sugerencia"},
    {"comment": "Sería útil que los apagones tuvieran una programación mensual fija.", "label": "sugerencia"},
    {"comment": "Los trámites legales se podrían simplificar con más formularios digitales.", "label": "sugerencia"},
    {"comment": "¿Y si se hace una aplicación para consultar precios oficiales del agro?", "label": "sugerencia"},
    {"comment": "Podrían promover mercados móviles en barrios lejanos.", "label": "sugerencia"},
    {"comment": "Sería genial que las aulas tuvieran mejor iluminación natural.", "label": "sugerencia"},
    {"comment": "Estaría bien tener más actividades culturales al aire libre.", "label": "sugerencia"},
    {"comment": "¿Por qué no se habilitan centros de acopio de libros usados?", "label": "sugerencia"},
    {"comment": "Podrían dar más apoyo a los cuentapropistas con capacitaciones gratuitas.", "label": "sugerencia"},
    {"comment": "Sería bueno que los trámites de licencia para negocios fueran más rápidos.", "label": "sugerencia"},
    {"comment": "Los programas de TV deberían tener más participación ciudadana en vivo.", "label": "sugerencia"},
    {"comment": "Podrían hacer una sección fija en la radio con respuestas a dudas del pueblo.", "label": "sugerencia"},
]




# Import pandas at the top of the file
import pandas as pd
import os

date = '(sabado. 5 de abril de 2025)'

# List of all categories and their corresponding data
categories = [
    # ('transporte', denuncia_transporte),
    # ('electrica', denuncia_electricidad),
    # ('telecomunicaciones', denuncia_telecom),
    # # ('banco', denuncia_bancos),
    # ('mlc_tienda', denuncia_tiendas),
    # ('salud', denuncia_salud),
    # ('agua', denuncia_agua),
    # # ('postal', denuncia_correos),
    # # ('permutas', denuncia_vivienda),
    ('otros', comentarios_sugerencia)
]

# Create and save CSV files with category-based folders
for category_name, data in categories:
    # Create folder path
    folder_path = os.path.join('input', category_name)
    
    # Create folder if it doesn't exist
    os.makedirs(folder_path, exist_ok=True)
    
    # Create filename with date
    filename = f'ia-{category_name}{date}.csv'
    full_path = os.path.join(folder_path, filename)
    
    # Verificar si el archivo ya existe
    if os.path.exists(full_path):
        try:
            # Leer el archivo existente
            existing_df = pd.read_csv(full_path, encoding='utf-8')
            
            # Convertir los nuevos datos a DataFrame
            new_df = pd.DataFrame(data)
            
            # Concatenar los datos existentes con los nuevos
            combined_df = pd.concat([existing_df, new_df], ignore_index=True)
            
            # Eliminar duplicados si los hay (basado en el texto del comentario)
            combined_df = combined_df.drop_duplicates(subset=['comment'], keep='first')
            
            # Guardar el archivo combinado
            combined_df.to_csv(full_path, index=False, encoding='utf-8')
            print(f'Actualizado: {full_path} con {len(new_df)} nuevos elementos')
            
        except Exception as e:
            print(f'Error al actualizar {full_path}: {e}')
            
    else:
        # Si el archivo no existe, crear uno nuevo
        pd.DataFrame(data).to_csv(full_path, index=False, encoding='utf-8')
        print(f'Creado nuevo archivo: {full_path}')