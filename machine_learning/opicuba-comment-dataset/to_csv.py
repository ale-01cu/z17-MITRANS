
comentarios_sugerencia = [
    {"comment": "Sería buenísimo si pudieran implementar un sistema de reservas online para la bodega, así evitaríamos las colas interminables.", "label": "sugerencia"},
    {"comment": "¿Podrían hacer más frecuentes las rutas de guaguas? A veces paso horas esperando y al final no hay espacio para subirme.", "label": "sugerencia"},
    {"comment": "Me parece que deberían habilitar un servicio de entrega a domicilio para la canasta básica, como se hace en otros países.", "label": "sugerencia"},
    {"comment": "Sería ideal si pudieran mejorar la calidad del agua en mi barrio, está muy turbia y no se puede ni beber.", "label": "sugerencia"},
    {"comment": "¿Qué tal si las clases de educación física se pudieran dar en un horario más adecuado, no siempre hay espacio en el gimnasio?", "label": "sugerencia"},
    {"comment": "Podrían aumentar el número de tiendas de MLC, hay tantas personas que necesitan comprar productos allí y no hay suficientes lugares.", "label": "sugerencia"},
    {"comment": "Sería genial si pudieran implementar pagos digitales en las guaguas, así se evitarían las largas colas para comprar los boletos.", "label": "sugerencia"},
    {"comment": "Sería útil que pusieran más información sobre el horario de las actividades culturales en los barrios, así más gente podría asistir.", "label": "sugerencia"},
    {"comment": "¿Qué tal si los servicios médicos ofrecieran consultas virtuales para evitar que las personas tengan que trasladarse tanto?", "label": "sugerencia"},
    {"comment": "Podrían organizar las colas en la tienda de la esquina de manera más ordenada, y que alguien supervise que no se cuelen.", "label": "sugerencia"},
    {"comment": "Me gustaría que pusieran más parques en el municipio, hay pocos espacios verdes para los niños y es importante que tengan donde jugar.", "label": "sugerencia"},
    {"comment": "Sería una buena idea que las tiendas pudieran ofrecer productos de limpieza más variados, no solo los mismos de siempre.", "label": "sugerencia"},
    {"comment": "Deberían permitir más acceso a internet en las zonas rurales, así los campesinos y trabajadores pueden estar más conectados.", "label": "sugerencia"},
    {"comment": "¿Por qué no crear más rutas de transporte interprovincial para facilitar los viajes entre las provincias?", "label": "sugerencia"},
    {"comment": "Sería genial que los restaurantes pudieran tener un menú en línea, especialmente en tiempos de pandemia, para reducir el contacto.", "label": "sugerencia"},
    {"comment": "Tal vez podrían mejorar la señalización en los hospitales, hay tanta gente que se pierde buscando las consultas.", "label": "sugerencia"},
    {"comment": "Sería bueno que los precios en los mercados agropecuarios estuvieran más regulados, porque están muy altos en algunos lugares.", "label": "sugerencia"},
    {"comment": "¿Qué tal si pudieran ampliar las horas de atención en las oficinas de ETECSA? A veces uno tiene que hacer gestiones fuera del horario laboral.", "label": "sugerencia"},
    {"comment": "Podrían facilitar los trámites para obtener productos en la tienda de electrodomésticos, a veces hay tanta burocracia.", "label": "sugerencia"},
    {"comment": "Sería conveniente que se habilitaran más espacios para estudiar en las universidades, hay mucha demanda y no hay suficientes aulas.", "label": "sugerencia"},
    {"comment": "Sería ideal si los precios en las tiendas en moneda nacional estuvieran más alineados con los ingresos de la gente, son muy altos en comparación.", "label": "sugerencia"},
    {"comment": "¿Qué tal si las guaguas de larga distancia pudieran ofrecer mejores servicios, como Wi-Fi o aire acondicionado?", "label": "sugerencia"},
    {"comment": "Deberían habilitar más parques industriales para que las pequeñas empresas puedan producir más y exportar productos.", "label": "sugerencia"},
    {"comment": "Sería bueno si las autoridades pusieran más atención al estado de las calles, muchas están llenas de huecos y no son seguras para circular.", "label": "sugerencia"},
    {"comment": "Me gustaría que se pudiera pagar en la tienda a través de una app en lugar de tener que pagar con efectivo, así es más rápido.", "label": "sugerencia"},
    {"comment": "Podrían ofrecer más actividades recreativas para los jóvenes en los barrios, hay pocas opciones de entretenimiento.", "label": "sugerencia"},
    {"comment": "Sería interesante si los supermercados pudieran vender productos orgánicos a precios más accesibles.", "label": "sugerencia"},
    {"comment": "Deberían poner más atención a la limpieza de las playas, ya que no siempre están en buen estado para los turistas y los locales.", "label": "sugerencia"},
    {"comment": "Sería útil que los hospitales ofrecieran servicios de salud mental, ya que es un tema muy importante que a veces se ignora.", "label": "sugerencia"},
    {"comment": "Sería excelente si pudieran mejorar la puntualidad de las guaguas, a veces pasan con retraso y eso hace perder tiempo.", "label": "sugerencia"},
    {"comment": "Creo que sería bueno aumentar la cantidad de becas para los estudiantes de educación superior, muchas familias no pueden pagar los estudios.", "label": "sugerencia"},
    {"comment": "¿Qué tal si pusieran más señales de tráfico para prevenir accidentes en las intersecciones más peligrosas?", "label": "sugerencia"},
    {"comment": "Podrían ofrecer más talleres de formación para jóvenes emprendedores, hay mucho talento que no sabe cómo empezar.", "label": "sugerencia"},
    {"comment": "Sería genial si los supermercados pudieran ofrecer más productos cubanos, eso ayudaría a los pequeños productores.", "label": "sugerencia"},
    {"comment": "Sería bueno que las escuelas tuvieran más recursos para actividades extracurriculares, así los niños pueden aprender más fuera del aula.", "label": "sugerencia"},
    {"comment": "Deberían poner más atención a la seguridad en los parques públicos, especialmente por las noches, hay muchas personas con malas intenciones.", "label": "sugerencia"},
    {"comment": "¿Por qué no implementan un sistema de puntos para premiar a los clientes frecuentes en las tiendas?", "label": "sugerencia"},
    {"comment": "Sería positivo si pudieran facilitar el acceso a la cultura mediante más representaciones teatrales y musicales en las comunidades.", "label": "sugerencia"},
    {"comment": "Deberían crear más programas de apoyo para los ancianos, muchos viven solos y no tienen acceso a servicios médicos básicos.", "label": "sugerencia"},
    {"comment": "Sería útil que el transporte público tuviera un sistema de señalización digital para indicar el tiempo estimado de llegada.", "label": "sugerencia"},
    {"comment": "¿Por qué no poner más atención a los productores locales en los mercados, que están perdiendo frente a los productos importados?", "label": "sugerencia"},
    {"comment": "Sería excelente si el sistema de salud pudiera ofrecer más especialidades médicas en los municipios, ya que las personas tienen que viajar mucho para consultas.", "label": "sugerencia"},
    {"comment": "Sería ideal si pudieran mejorar las condiciones laborales en las tiendas, para que los trabajadores tengan un mejor ambiente y atención al cliente.", "label": "sugerencia"},
    {"comment": "¿Por qué no mejorar las condiciones de trabajo en las fábricas de alimentos, algunos productos tienen una calidad muy baja?", "label": "sugerencia"},
    {"comment": "Sería útil que en las tiendas de tecnología hubiera más opciones para comprar repuestos, no solo los mismos productos.", "label": "sugerencia"},
    {"comment": "Creo que sería una buena idea si se pudiera comprar productos en línea y recogerlos en las tiendas físicas, para evitar las colas.", "label": "sugerencia"},
    {"comment": "Deberían ofrecer más soluciones ecológicas en las fábricas de productos de consumo, el medio ambiente necesita más atención.", "label": "sugerencia"},
    {"comment": "Sería genial que pudieran mejorar los horarios de las farmacias, muchas veces no hay tiempo de comprar medicinas fuera del horario laboral.", "label": "sugerencia"},
    {"comment": "Sería útil que el servicio de agua pudiera tener más detalles sobre los horarios de corte y restablecimiento.", "label": "sugerencia"},
    {"comment": "¿Podrían ofrecer más cursos de capacitación para los trabajadores de la construcción? La mayoría no tiene acceso a cursos actualizados.", "label": "sugerencia"},
    {"comment": "Sería buenísimo si pudieran organizar más eventos culturales y deportivos para los jóvenes en las comunidades.", "label": "sugerencia"},
    {"comment": "Creo que sería positivo si las tiendas pudieran tener un sistema de reciclaje para las bolsas plásticas, es una buena forma de cuidar el ambiente.", "label": "sugerencia"},
    {"comment": "Deberían ofrecer descuentos a las personas mayores en el transporte público, ya que muchos no tienen suficientes recursos para moverse por la ciudad.", "label": "sugerencia"},
    {"comment": "Sería genial si pudieran facilitar la compra de productos médicos esenciales en línea, para evitar desplazamientos innecesarios.", "label": "sugerencia"},
    {"comment": "Creo que sería una buena idea dar más incentivos a los trabajadores del sector público, ya que están haciendo un esfuerzo enorme en tiempos difíciles.", "label": "sugerencia"}
]




# Import pandas at the top of the file
import pandas as pd
import os

date = '(sabado. 5 de abril de 2025)'

# List of all categories and their corresponding data
categories = [
    # ('transporte', denuncia_transporte),
    # ('electrica', denuncia_electricidad),
    # ('telecomunicaciones', denuncia_telecom),
    # # ('banco', denuncia_bancos),
    # ('mlc_tienda', denuncia_tiendas),
    # ('salud', denuncia_salud),
    # ('agua', denuncia_agua),
    # # ('postal', denuncia_correos),
    # # ('permutas', denuncia_vivienda),
    ('otros', comentarios_sugerencia)
]

# Create and save CSV files with category-based folders
for category_name, data in categories:
    # Create folder path
    folder_path = os.path.join('input', category_name)
    
    # Create folder if it doesn't exist
    os.makedirs(folder_path, exist_ok=True)
    
    # Create filename with date
    filename = f'ia-{category_name}{date}.csv'
    full_path = os.path.join(folder_path, filename)
    
    # Verificar si el archivo ya existe
    if os.path.exists(full_path):
        try:
            # Leer el archivo existente
            existing_df = pd.read_csv(full_path, encoding='utf-8')
            
            # Convertir los nuevos datos a DataFrame
            new_df = pd.DataFrame(data)
            
            # Concatenar los datos existentes con los nuevos
            combined_df = pd.concat([existing_df, new_df], ignore_index=True)
            
            # Eliminar duplicados si los hay (basado en el texto del comentario)
            combined_df = combined_df.drop_duplicates(subset=['comment'], keep='first')
            
            # Guardar el archivo combinado
            combined_df.to_csv(full_path, index=False, encoding='utf-8')
            print(f'Actualizado: {full_path} con {len(new_df)} nuevos elementos')
            
        except Exception as e:
            print(f'Error al actualizar {full_path}: {e}')
            
    else:
        # Si el archivo no existe, crear uno nuevo
        pd.DataFrame(data).to_csv(full_path, index=False, encoding='utf-8')
        print(f'Creado nuevo archivo: {full_path}')